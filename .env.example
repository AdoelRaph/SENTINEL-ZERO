# ============================================================================
# Sentinel-Zero Environment Configuration Template
# Copy this file to .env and fill in your actual values
# NEVER commit .env to git - keep your secrets safe!
# ============================================================================

# ============================================================================
# REQUIRED: Neon PostgreSQL Connection
# Get your connection string from: https://console.neon.tech
# Format: postgresql://user:password@host/database?sslmode=require
# ============================================================================
DATABASE_URL=postgresql://your_user:your_password@your-host.neon.tech/your_database?sslmode=require

# Neon PostgreSQL Pool Configuration
NEON_POOL_SIZE=20
NEON_MAX_OVERFLOW=10
NEON_POOL_TIMEOUT=30
NEON_POOL_RECYCLE=1800
NEON_ECHO_SQL=false

# ============================================================================
# REQUIRED: Cloudflare R2 Storage
# Get credentials from: Cloudflare Dashboard -> R2 -> Manage R2 API Tokens
# Create a new API token with read/write permissions
# ============================================================================
R2_ACCOUNT_ID=your_cloudflare_account_id_here
R2_ACCESS_KEY_ID=your_r2_access_key_id_here
R2_SECRET_ACCESS_KEY=your_r2_secret_access_key_here
R2_BUCKET_NAME=sentinel-zero-storage
R2_ENDPOINT_URL=https://your_account_id.r2.cloudflarestorage.com
R2_REGION=auto

# ============================================================================
# REQUIRED: API Security Keys
# Generate secure keys using the crypto utility:
# python -c "from utils.crypto import generate_encryption_key; print(generate_encryption_key())"
# KEEP THESE SECRET! Never share or commit to version control
# ============================================================================
API_SECRET_KEY=change_this_to_minimum_32_character_random_string_for_production
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24
ENCRYPTION_KEY=generate_a_fernet_key_using_the_crypto_utility

# ============================================================================
# OPTIONAL: Threat Intelligence API Keys
# NIST NVD API Key (get from: https://nvd.nist.gov/developers/request-an-api-key)
# Free tier: 5 requests/30 seconds | With key: 50 requests/30 seconds
# ============================================================================
NIST_NVD_API_KEY=your_nvd_api_key_here_or_leave_blank
CISA_API_ENABLED=true

# ============================================================================
# ML Engine Configuration
# Adjust these based on your hardware and detection sensitivity needs
# ============================================================================
ML_RETRAIN_INTERVAL_DAYS=7
ML_ANOMALY_THRESHOLD=0.15
ML_MODEL_VERSION=1.0.0
ML_N_ESTIMATORS=200
ML_CONTAMINATION=0.1
ML_MAX_SAMPLES=10000
ML_TIME_WINDOW_SECONDS=300
ML_MIN_TRAINING_SAMPLES=10000
ML_LOOP_PACKET_THRESHOLD=1000
ML_LOOP_TIME_WINDOW=10
ML_SUSPICIOUS_PORT_THRESHOLD=1024

# ============================================================================
# Network Scanner Configuration
# IMPORTANT: Update SCANNER_NMAP_PATH to match YOUR system!
# Windows: C:\Program Files (x86)\Nmap\nmap.exe
# Linux/Mac: /usr/bin/nmap
# ============================================================================
SCANNER_TIMEOUT_SECONDS=30
SCANNER_MAX_CONCURRENT=100

# Windows (uncomment if using Windows):
# SCANNER_NMAP_PATH=C:\Program Files (x86)\Nmap\nmap.exe

# Linux/Mac (uncomment if using Linux/Mac):
SCANNER_NMAP_PATH=/usr/bin/nmap

# Port scanning configuration
SCANNER_QUICK_SCAN_PORTS=21-23,25,53,80,110,143,443,445,993,995,3306,3389,5432,8080
SCANNER_FULL_SCAN_PORTS=1-65535
SCANNER_WIRELESS_SCAN_ENABLED=false

# ============================================================================
# Remediation Agent Configuration
# Controls automated patching behavior
# ============================================================================
REMEDIATION_AUTO_APPROVE_LOW_RISK=false
REMEDIATION_SSH_TIMEOUT=60
REMEDIATION_MAX_RETRIES=3
REMEDIATION_REQUIRE_DUAL_APPROVAL=true

# ============================================================================
# Logging Configuration
# ============================================================================
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_SYSLOG_ENABLED=false
LOG_SYSLOG_HOST=localhost
LOG_SYSLOG_PORT=514

# ============================================================================
# Application Configuration
# ============================================================================
APP_NAME=Sentinel-Zero
APP_VERSION=1.0.0
ENVIRONMENT=development

# ============================================================================
# SETUP CHECKLIST:
# [ ] Created Neon PostgreSQL database and added connection string
# [ ] Created Cloudflare R2 bucket and added credentials
# [ ] Generated secure API_SECRET_KEY (min 32 characters)
# [ ] Generated ENCRYPTION_KEY using crypto utility
# [ ] Updated SCANNER_NMAP_PATH to match your system
# [ ] (Optional) Obtained NIST NVD API key for faster threat intel
# [ ] Renamed this file from .env.example to .env
# [ ] Added .env to .gitignore (should already be there)
# ============================================================================
